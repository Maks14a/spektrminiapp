<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–°–ü–ï–ö–¢–†</title>

    <link rel="stylesheet" href="styles.css" />

    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* –°—Ç–∏–ª–∏ –¥–ª—è –≥–∞–ª–µ—Ä–µ–∏ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π */
        .gallery-track {
            gap: 15px;
            scroll-behavior: smooth;
            padding: 0 15px;
            display: flex;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            -webkit-overflow-scrolling: touch;
        }

        .gallery-item {
            flex: 0 0 100%;
            max-height: 80vh;
            width: 100%;
            object-fit: contain;
            border-radius: 32px;
            scroll-snap-align: start;
        }

        .gallery.dragging {
            cursor: grabbing;
        }

        /* –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ —Ñ–æ–Ω–∞ */
        .dikidi-modal {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0,0,0,0.8);
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0;
            margin: 0;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.4s ease;
        }
        .dikidi-modal.show {
            opacity: 1;
            pointer-events: auto; /* –†–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ —Å–æ–±—ã—Ç–∏—è, –∫–æ–≥–¥–∞ –ø–æ–∫–∞–∑–∞–Ω */
        }

        /* —Å–∞–º ¬´–ø–æ–ø‚Äë–∞–ø¬ª: –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π iframe */
        .dikidi-iframe {
            width: 100vw;
            height: 100vh;
            max-width: 100%;
            max-height: 100%;
            border: none;
            border-radius: 0px;
            background: #fff;
            opacity: 0;
            transition: opacity 0.4s ease;
            box-sizing: border-box;
        }
        .dikidi-iframe.loaded {
            opacity: 1;
        }

        /* –∫—Ä–µ—Å—Ç–∏–∫ –∑–∞–∫—Ä—ã—Ç—å */
        .dikidi-close {
            position: absolute;
            top: 18px;
            right: 22px;
            font-size: 36px;
            color: #fff;
            cursor: pointer;
            user-select: none;
            line-height: 1;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ª–æ–∞–¥–µ—Ä–∞ */
        .dikidi-loader {
            border: 8px solid #555; /* –¢–µ–º–Ω–æ-—Å–µ—Ä—ã–π –¥–ª—è —Ç–µ–ª–∞ –∫—Ä—É–≥–∞ */
            border-top: 8px solid rgb(240, 191, 76); /* –û—Ä–∞–Ω–∂–µ–≤—ã–π RGB: 240, 191, 76 –¥–ª—è –≤—Ä–∞—â–∞—é—â–µ–π—Å—è —á–∞—Å—Ç–∏ */
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 2s linear infinite;
            position: absolute; /* Position over the iframe area */
            z-index: 2001; /* Ensure it's above the modal background but below close button */
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>

<body>
<div id="overlay-modal" class="overlay-modal" aria-hidden="true">
  <button class="overlay-close" id="overlay-close" aria-label="–ó–∞–∫—Ä—ã—Ç—å">‚úñ</button>
  <div class="overlay-content" id="overlay-content"></div>
</div>
    <div id="intro-screen">
        <video id="intro-video" autoplay muted playsinline preload="auto">
            <source src="–ø—Ä–µ–≤—å—é.mp4" type="video/mp4" />
            –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ.
        </video>
    </div>

    <div class="container" id="main-content">
        <img src="logo2.png" alt="–°–ü–ï–ö–¢–†" class="logo" />
        <div class="buttons">
            <button id="show-appointment-btn" class="btn btn-primary">–ó–ê–ü–ò–°–ê–¢–¨–°–Ø</button>
            <button id="show-events-btn" class="btn btn-outline">–ï–í–ï–ù–¢–´</button>
        </div>

        <img id="about-circle"    src="about.jpg"    alt="–û –Ω–∞—Å"     class="circle-img circle1" />
        <img id="teachers-circle" src="teachers.jpg" alt="–ü–µ–¥–∞–≥–æ–≥–∏"  class="circle-img circle2" />

        <div class="circle-text circle1-text" id="about-text">
            <strong>–ú—ã</strong> - –í–∞—à –≤—Ç–æ—Ä–æ–π –¥–æ–º
        </div>

        <div class="circle-text circle2-text" id="teachers-text">
            <strong>–° –≤–∞–º–∏</strong> —Ä—É–∫–∞ –æ–± —Ä—É–∫—É
        </div>

    </div>

    <div class="container" id="appointment-screen">
        <div class="back-button" id="back-to-main-from-appointment"></div>

        <div class="appointment-layout-grid">
            <div class="image-circle"><img src="1.jpg" alt="–º–∏–∫—Ä–æ—Ñ–æ–Ω" /></div>
            <div class="image-circle"><img src="2.jpg" alt="–º–∏–∫—Ä–æ—Ñ–æ–Ω" /></div>

            <button id="dikidi-book-btn" class="btn btn-yellow grid-button">–ó–ê–ü–ò–°–ê–¢–¨–°–Ø</button>

            <div class="image-circle"><img src="3.jpg" alt="–º–∏–∫—Ä–æ—Ñ–æ–Ω" /></div>
            <div class="image-circle"><img src="4.jpg" alt="–º–∏–∫—Ä–æ—Ñ–æ–Ω" /></div>
        </div>

        <img src="logo3.png" alt="–õ–æ–≥–æ—Ç–∏–ø" class="footer-logo" />
    </div>

    <div class="container" id="events-screen">
        <div class="back-button" id="back-to-main-from-events"></div>

        <div class="events-carousel-wrapper">
            <div class="events-carousel" id="events-carousel">
                </div>
        </div>

        <div class="events-pagination" id="events-pagination"></div>

        <!-- ========== –ò–ó–ú–ï–ù–ï–ù–ò–ï –ó–î–ï–°–¨: –ù–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞-—Å—Å—ã–ª–∫–∞ ========== -->
        <a href="https://t.me/mmariiism" target="_blank" id="request-btn" class="btn btn-yellow">–û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</a>

        <img src="logo3.png" alt="–õ–æ–≥–æ—Ç–∏–ø" class="footer-logo-static" />
    </div>

</script>
    document.addEventListener('DOMContentLoaded', () => {
    
        /* ---------- DOM Element References ---------- */
        const introScreen = document.getElementById('intro-screen');
        const introVideo = document.getElementById('intro-video');
        const mainContent = document.getElementById('main-content');
        const appointmentScreen = document.getElementById('appointment-screen');
        const eventsScreen = document.getElementById('events-screen');
        const showAppointmentBtn = document.getElementById('show-appointment-btn');
        const showEventsBtn = document.getElementById('show-events-btn');
        const backToMainFromAppointmentBtn = document.getElementById('back-to-main-from-appointment');
        const backToMainFromEventsBtn = document.getElementById('back-to-main-from-events');
        const eventsCarousel = document.getElementById('events-carousel');
        const eventsPagination = document.getElementById('events-pagination');
        const allScreens = [mainContent, appointmentScreen, eventsScreen];
    
        let autoScrollInterval;
        let numOriginalItems = 0;
        
        // –ù–û–í–û–ï: –§–ª–∞–≥ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–Ω—Ç—Ä–æ
        let isIntroFinished = false;
    
        /* =================================================================
           –û–ë–ù–û–í–õ–ï–ù–û: –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–æ–≤.
           ================================================================= */
        function switchScreen(screenToShow) {
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–ª–∞–≤–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            eventsCarousel.style.scrollBehavior = 'smooth'; 
    
            allScreens.forEach(screen => {
                if (screen !== screenToShow) {
                    screen.classList.remove('show');
                }
            });
            screenToShow.classList.add('show');
            
            if (screenToShow === eventsScreen) {
                startAutoScroll();
            } else {
                stopAutoScroll();
            }
        }
        
        /* =================================================================
            –û–ë–ù–û–í–õ–ï–ù–û: –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–Ω—Ç—Ä–æ.
            –û–Ω–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ñ–ª–∞–≥ `isIntroFinished` –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω,
            —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –µ—â—ë –Ω–µ –ø–µ—Ä–µ—à—ë–ª –Ω–∞ –¥—Ä—É–≥–æ–π.
           ================================================================= */
        function finishIntro() {
            // –ï—Å–ª–∏ –∏–Ω—Ç—Ä–æ —É–∂–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ, –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º.
            if (isIntroFinished) {
                return;
            }
    
            introScreen.classList.add('hidden');
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥ –≤ true
            isIntroFinished = true;
    
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª –ª–∏ —É–∂–µ –ø–æ–∫–∞–∑–∞–Ω –∫–∞–∫–æ–π-–ª–∏–±–æ —ç–∫—Ä–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.
            const aScreenIsAlreadyShown = allScreens.some(screen => screen.classList.contains('show'));
            
            // –ï—Å–ª–∏ –Ω–∏ –æ–¥–∏–Ω —ç–∫—Ä–∞–Ω –µ—â—ë –Ω–µ –∞–∫—Ç–∏–≤–µ–Ω, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≥–ª–∞–≤–Ω—ã–π.
            if (!aScreenIsAlreadyShown) {
                switchScreen(mainContent);
            }
        }
    
        /* ---------- Screen Transition Logic ---------- */
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ `ended` –¥–ª—è –≤–∏–¥–µ–æ
        introVideo.addEventListener('ended', finishIntro);
    
        const playPromise = introVideo.play();
        if (playPromise !== undefined) {
            playPromise.catch(error => {
                console.error("Autoplay was blocked:", error);
                // –ï—Å–ª–∏ –∞–≤—Ç–æ–ø—Ä–æ–∏–≥—Ä—ã–≤–∞–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ, —Å—Ä–∞–∑—É –≤—ã–∑—ã–≤–∞–µ–º finishIntro.
                finishIntro();
            });
        }
    
        // Fallback —Ç–∞–π–º–µ—Ä
        setTimeout(() => {
            finishIntro();
        }, 5000);
    
        // –ò–°–ü–†–ê–í–õ–ï–ù–û: –¢–µ–ø–µ—Ä—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∏–∫–æ–≤ —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è—é—Ç, –∑–∞–≤–µ—Ä—à–∏–ª–æ—Å—å –ª–∏ –∏–Ω—Ç—Ä–æ.
        showAppointmentBtn.onclick = () => {
            if (!isIntroFinished) return; // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –Ω–∞–∂–∞—Ç–∏–µ, –µ—Å–ª–∏ –∏–Ω—Ç—Ä–æ –µ—â—ë –Ω–µ –∑–∞–∫–æ–Ω—á–∏–ª–æ—Å—å
            switchScreen(appointmentScreen);
        };
    
        showEventsBtn.onclick = () => {
            if (!isIntroFinished) return; // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –Ω–∞–∂–∞—Ç–∏–µ
            switchScreen(eventsScreen);
            loadEvents();
        };
    
        backToMainFromAppointmentBtn.onclick = () => {
            switchScreen(mainContent);
        };
    
        backToMainFromEventsBtn.onclick = () => {
            switchScreen(mainContent);
        };
    
        /* =================================================================
           –û—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ ‚Äî –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
           ================================================================= */
        
        function getSlideStep() {
            if (eventsCarousel.children.length === 0) return 0;
            const firstItem = eventsCarousel.children[0];
            const itemWidth = firstItem.clientWidth;
            const style = window.getComputedStyle(firstItem);
            const marginRight = parseFloat(style.marginRight);
            return itemWidth + marginRight;
        }
    
        function createDots() {
            eventsPagination.innerHTML = '';
            if (numOriginalItems === 0) return;
    
            const slideStep = getSlideStep();
            if (slideStep === 0) return;
    
            for (let i = 0; i < numOriginalItems; i++) {
                const dot = document.createElement('span');
                dot.className = 'pagination-dot';
                dot.addEventListener('click', () => {
                    eventsCarousel.scrollTo({ left: (i + numOriginalItems) * slideStep, behavior: 'smooth' });
                });
                eventsPagination.appendChild(dot);
            }
            updateDots();
        }
    
        function updateDots() {
            const dots = eventsPagination.querySelectorAll('.pagination-dot');
            if (eventsCarousel.children.length === 0 || numOriginalItems === 0) {
                dots.forEach(dot => dot.classList.remove('active'));
                return;
            }
    
            const slideStep = getSlideStep();
            if (slideStep === 0) return;
    
            const adjustedScrollLeft = eventsCarousel.scrollLeft - (numOriginalItems * slideStep);
            let activeIndex = Math.round(adjustedScrollLeft / slideStep);
    
            if (activeIndex < 0) {
                activeIndex = (numOriginalItems + (activeIndex % numOriginalItems)) % numOriginalItems;
            } else if (activeIndex >= numOriginalItems) {
                activeIndex = activeIndex % numOriginalItems;
            }
    
            dots.forEach((dot, index) => {
                dot.classList.toggle('active', index === activeIndex);
            });
        }
    
        eventsCarousel.addEventListener('scroll', () => {
            updateDots();
            handleInfiniteScroll();
        }, { passive: true });
    
        const API_STATIC = "https://apispectrminiapp-vozmak.amvera.io/static/";
        const API_FILES = "https://apispectrminiapp-vozmak.amvera.io/files";
        const API_TEACHERS_STATIC = "https://apispectrminiapp-vozmak.amvera.io/static/Teachers/";
        const API_TEACHERS_FILES = "https://apispectrminiapp-vozmak.amvera.io/teachers/files";
    
        async function loadEvents() {
            try {
                const filesResponse = await fetch(API_FILES);
                if (!filesResponse.ok) throw new Error(`HTTP error! status: ${filesResponse.status}`);
                const filesData = await filesResponse.json();
                const originalMediaFiles = filesData.files.filter(filename =>
                    filename.match(/\.(jpeg|jpg|gif|png|webp|avif|mp4)$/i)
                ) || [];
    
                eventsCarousel.innerHTML = '';
    
                if (originalMediaFiles.length > 0) {
                    numOriginalItems = originalMediaFiles.length;
                    const clonedBefore = originalMediaFiles.slice(-numOriginalItems);
                    const clonedAfter = originalMediaFiles.slice(0, numOriginalItems);
                    const combinedMedia = [...clonedBefore, ...originalMediaFiles, ...clonedAfter];
    
                    combinedMedia.forEach(filename => {
                        const mediaUrl = `${API_STATIC}${filename}`;
                        const fileExtension = filename.split('.').pop().toLowerCase();
                        const isVideo = fileExtension === 'mp4';
    
                        const eventDiv = document.createElement('div');
                        eventDiv.className = 'event-card';
    
                        let mediaElementHtml;
                        if (isVideo) {
                            mediaElementHtml = `<video src="${mediaUrl}" class="event-image" autoplay loop muted playsinline></video>`;
                        } else {
                            mediaElementHtml = `<img src="${mediaUrl}" alt="Event Image" class="event-image">`;
                        }
                        eventDiv.innerHTML = `${mediaElementHtml}`;
                        eventsCarousel.appendChild(eventDiv);
                    });
    
                    const slideStep = getSlideStep();
                    if (slideStep > 0) {
                        eventsCarousel.scrollLeft = numOriginalItems * slideStep;
                    }
                    createDots();
                } else {
                    eventsCarousel.innerHTML = '<p class="no-events">–ü–æ–∫–∞ –Ω–µ—Ç –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏—Ö —Å–æ–±—ã—Ç–∏–π.</p>';
                    eventsPagination.innerHTML = '';
                    numOriginalItems = 0;
                }
            } catch (error) {
                console.error('Error loading event files:', error);
                eventsCarousel.innerHTML = '<p class="error-message">–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ–±—ã—Ç–∏—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.</p>';
                eventsPagination.innerHTML = '';
                numOriginalItems = 0;
            }
        }
    
        function startAutoScroll() {
            stopAutoScroll();
            autoScrollInterval = setInterval(() => {
                if (numOriginalItems === 0) return;
                const slideStep = getSlideStep();
                if (slideStep === 0) return;
                eventsCarousel.scrollBy({ left: slideStep, behavior: 'smooth' });
            }, 7000);
        }
    
        function stopAutoScroll() {
            if (autoScrollInterval) {
                clearInterval(autoScrollInterval);
                autoScrollInterval = null;
            }
        }
    
        function handleInfiniteScroll() {
            if (numOriginalItems === 0) return;
            const slideStep = getSlideStep();
            if (slideStep === 0) return;
            const currentScrollLeft = eventsCarousel.scrollLeft;
            const startOfRealContent = numOriginalItems * slideStep;
            const endOfRealContent = (numOriginalItems * 2) * slideStep;
            
            if (currentScrollLeft >= endOfRealContent) {
                eventsCarousel.style.scrollBehavior = 'auto';
                eventsCarousel.scrollLeft = startOfRealContent + (currentScrollLeft - endOfRealContent);
                requestAnimationFrame(() => {
                    eventsCarousel.style.scrollBehavior = 'smooth';
                });
            } else if (currentScrollLeft < startOfRealContent) {
                eventsCarousel.style.scrollBehavior = 'auto';
                eventsCarousel.scrollLeft = endOfRealContent - (startOfRealContent - currentScrollLeft);
                requestAnimationFrame(() => {
                    eventsCarousel.style.scrollBehavior = 'smooth';
                });
            }
        }
    
        /* ---------- DIKIDI Widget Logic ---------- */
        const WIDGET_URL = 'https://dikidi.ru/#widget=190962';
        const btnBook = document.getElementById('dikidi-book-btn');
        btnBook.addEventListener('click', openDikidiModal);
    
        function openDikidiModal() {
            if (document.querySelector('.dikidi-modal')) return;
    
            const modal = document.createElement('div');
            modal.className = 'dikidi-modal';
    
            const close = document.createElement('span');
            close.className = 'dikidi-close';
            close.textContent = '√ó';
            close.onclick = () => {
                modal.classList.remove('show');
                setTimeout(() => modal.remove(), 250);
            };
    
            const loader = document.createElement('div');
            loader.className = 'dikidi-loader';
    
            const frame = document.createElement('iframe');
            frame.src = WIDGET_URL;
            frame.className = 'dikidi-iframe';
            frame.allow = 'payment *; fullscreen';
    
            frame.style.width = `${window.innerWidth}px`;
            frame.style.height = `${window.innerHeight}px`;
    
            frame.onload = () => {
                loader.remove();
                frame.classList.add('loaded');
            };
    
            modal.appendChild(loader);
            modal.appendChild(frame);
            modal.appendChild(close);
            document.body.appendChild(modal);
            requestAnimationFrame(() => modal.classList.add('show'));
        }
    
        /* ---------- Carousel Dragging Logic ---------- */
        let isDown = false;
        let startX;
        let scrollLeft;
        let wheelTimeout;
    
        function startDragging(e) {
            isDown = true;
            eventsCarousel.classList.add('dragging');
            startX = (e.pageX || e.touches[0].pageX) - eventsCarousel.offsetLeft;
            scrollLeft = eventsCarousel.scrollLeft;
            stopAutoScroll();
        }
    
        function stopDragging() {
            isDown = false;
            eventsCarousel.classList.remove('dragging');
            if (eventsScreen.classList.contains('show')) {
                startAutoScroll();
            }
        }
    
        function drag(e) {
            if (!isDown) return;
            e.preventDefault();
            const x = (e.pageX || e.touches[0].pageX) - eventsCarousel.offsetLeft;
            const walk = (x - startX) * 2;
            eventsCarousel.scrollLeft = scrollLeft - walk;
        }
    
        eventsCarousel.addEventListener('mousedown', startDragging);
        eventsCarousel.addEventListener('mouseleave', stopDragging);
        eventsCarousel.addEventListener('mouseup', stopDragging);
        eventsCarousel.addEventListener('mousemove', drag);
        eventsCarousel.addEventListener('touchstart', startDragging);
        eventsCarousel.addEventListener('touchend', stopDragging);
        eventsCarousel.addEventListener('touchcancel', stopDragging);
        eventsCarousel.addEventListener('touchmove', drag);
    
        eventsCarousel.addEventListener('wheel', (e) => {
            if (e.deltaY !== 0) {
                e.preventDefault();
                eventsCarousel.scrollLeft += e.deltaY;
                stopAutoScroll();
                clearTimeout(wheelTimeout);
                wheelTimeout = setTimeout(() => {
                    if (eventsScreen.classList.contains('show')) {
                        startAutoScroll();
                    }
                }, 1000);
            }
        });
    
        eventsCarousel.style.scrollBehavior = 'smooth';
    
        const aboutCircle = document.getElementById('about-circle');
        const teachersCircle = document.getElementById('teachers-circle');
        const overlayModal = document.getElementById('overlay-modal');
        const overlayContent = document.getElementById('overlay-content');
        const overlayClose = document.getElementById('overlay-close');
    
        function openOverlay(innerHTML){
            overlayContent.innerHTML = innerHTML;
            overlayModal.classList.add('show');
            document.body.style.overflow = 'hidden';
        }
        function closeOverlay(){
            overlayModal.classList.remove('show');
            overlayContent.classList.remove('gallery-open');
            overlayContent.classList.remove('gallery-fit');
            overlayContent.innerHTML = '';
            document.body.style.overflow = '';
        }
    
        overlayClose.addEventListener('click', closeOverlay);
        overlayModal.addEventListener('click', (e) => {
            if (e.target === overlayModal) closeOverlay();
        });
    
        if (aboutCircle) {
            aboutCircle.addEventListener('click', () => {
                overlayContent.classList.remove('gallery-open');
                overlayContent.classList.remove('gallery-fit');
                openOverlay(`
                <div class="about-content">
                    <h2 style="margin:0 0 10px 0;">–û –Ω–∞—Å</h2>
                    <p><strong>–í–æ–∫–∞–ª—å–Ω–∞—è —Å—Ç—É–¥–∏—è ¬´–°–ø–µ–∫—Ç—Ä¬ª</strong> ‚Äì —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ —à–∫–æ–ª–∞, —ç—Ç–æ –≤—Ç–æ—Ä–æ–π –¥–æ–º.</p>
                    <p><strong>–ó–¥–µ—Å—å –≤—ã —Å–º–æ–∂–µ—Ç–µ:</strong></p>
                    <p>üíõ –†–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ –≤–æ–∫–∞–ª—å–Ω–æ–π —Ç–µ—Ö–Ω–∏–∫–æ–π –∏ –ø—Ä–µ–æ–¥–æ–ª–µ–≤–∞—Ç—å —Å—Ç—Ä–∞—Ö–∏.</p>
                    <p>üíõ –£–∑–Ω–∞–≤–∞—Ç—å —Å–µ–±—è, —Ä–∞–∑–≤–∏–≤–∞—Ç—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –∏ —Ç–≤–æ—Ä—á–µ—Å–∫—É—é –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ—Å—Ç—å.</p>
                    <p>üíõ –£—á–∏—Ç—å—Å—è —Ç–æ–º—É, –∫–∞–∫ –≥–æ–ª–æ—Å –ø–µ—Ä–µ–¥–∞—ë—Ç –Ω–∞—Å—Ç–æ—è—â–∏–µ —ç–º–æ—Ü–∏–∏.</p>
                    </ul>
                    <p>–ú—ã —Å–æ–±–ª—é–¥–∞–µ–º –±–∞–ª–∞–Ω—Å —Å—Ç—Ä–æ–≥–æ—Å—Ç–∏ –∏ —É—é—Ç–∞: –≤—ã –ø–æ—á—É–≤—Å—Ç–≤—É–µ—Ç–µ —Å–µ–±—è –∫–∞–∫ –¥–æ–º–∞, –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º –±—É–¥–µ—Ç–µ —Ä–∞—Å—Ç–∏, —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞—Ç—å—Å—è –∏ –ø—Ä–µ–æ–¥–æ–ª–µ–≤–∞—Ç—å —Å–≤–æ–∏ –≥—Ä–∞–Ω–∏—Ü—ã.</p>
                    <p><strong>üíõ –í–∞—à —É—Å–ø–µ—Ö ‚Äî –Ω–∞—à–∞ —Ü–µ–ª—å, –∏ –º—ã –±—É–¥–µ–º —Ä—è–¥–æ–º —Å –≤–∞–º–∏, —Ä—É–∫–∞ –æ–± —Ä—É–∫—É.</strong></p>
                </div>
                `);
            });
        }
    
        if (teachersCircle) {
            teachersCircle.addEventListener('click', () => {
                overlayContent.classList.add('gallery-open');
                overlayContent.classList.add('gallery-fit');
                fetch(API_TEACHERS_FILES)
                    .then(response => {
                        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                        return response.json();
                    })
                    .then(data => {
                        const teacherFiles = data.files.filter(filename =>
                            filename.match(/\.(jpeg|jpg|gif|png|webp|avif)$/i)
                        ) || [];
    
                        if (teacherFiles.length > 0) {
                            const galleryHTML = `
                                <div class="gallery">
                                    <div class="gallery-track" id="gallery-track">
                                        ${teacherFiles.map(filename => `
                                            <img src="${API_TEACHERS_STATIC}${filename}"
                                                class="gallery-item"
                                                alt="–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å">`
                                        ).join('')}
                                    </div>
                                    <div class="gallery-dots" id="gallery-dots">
                                        ${teacherFiles.map((_, index) => `
                                            <span class="gallery-dot ${index === 0 ? 'active' : ''}"></span>`
                                        ).join('')}
                                    </div>
                                </div>
                            `;
                            openOverlay(galleryHTML);
    
                            requestAnimationFrame(() => {
                                const track = document.getElementById('gallery-track');
                                const dots = document.querySelectorAll('#gallery-dots .gallery-dot');
                                let isDown = false;
                                let startX;
                                let scrollLeft;
                                let autoScrollInterval;
                                function stepWidth() {
                                    const firstItem = track.querySelector('.gallery-item');
                                    if (!firstItem) return track.clientWidth;
                                    const styles = getComputedStyle(firstItem);
                                    const width = firstItem.clientWidth;
                                    const marginRight = parseFloat(styles.marginRight) || 0;
                                    return width + marginRight;
                                }
    
                                function updateDots() {
                                    const step = stepWidth();
                                    if (step === 0) return;
                                    const idx = Math.round(track.scrollLeft / step);
                                    dots.forEach((dot, i) => {
                                        dot.classList.toggle('active', i === idx);
                                    });
                                }
    
                                function startAutoScroll() {
                                    stopAutoScroll();
                                    autoScrollInterval = setInterval(() => {
                                        const step = stepWidth();
                                        if (track.scrollLeft >= (track.scrollWidth - track.clientWidth)) {
                                            track.scrollTo({ left: 0, behavior: 'smooth' });
                                        } else {
                                            track.scrollBy({ left: step, behavior: 'smooth' });
                                        }
                                    }, 7000);
                                }
    
                                function stopAutoScroll() {
                                    if (autoScrollInterval) {
                                        clearInterval(autoScrollInterval);
                                        autoScrollInterval = null;
                                    }
                                }
    
                                function startDragging(e) {
                                    isDown = true;
                                    track.classList.add('dragging');
                                    startX = (e.pageX || e.touches[0].pageX) - track.offsetLeft;
                                    scrollLeft = track.scrollLeft;
                                    stopAutoScroll();
                                }
    
                                function stopDragging() {
                                    isDown = false;
                                    track.classList.remove('dragging');
                                    startAutoScroll();
                                }
    
                                function drag(e) {
                                    if (!isDown) return;
                                    e.preventDefault();
                                    const x = (e.pageX || e.touches[0].pageX) - track.offsetLeft;
                                    const walk = (x - startX) * 2;
                                    track.scrollLeft = scrollLeft - walk;
                                }
    
                                track.addEventListener('mousedown', startDragging);
                                track.addEventListener('mouseleave', stopDragging);
                                track.addEventListener('mouseup', stopDragging);
                                track.addEventListener('mousemove', drag);
                                track.addEventListener('touchstart', startDragging);
                                track.addEventListener('touchend', stopDragging);
                                track.addEventListener('touchcancel', stopDragging);
                                track.addEventListener('touchmove', drag);
    
                                dots.forEach((dot, i) => {
                                    dot.addEventListener('click', () => {
                                        stopAutoScroll();
                                        const step = stepWidth();
                                        track.scrollTo({
                                            left: i * step,
                                            behavior: 'smooth'
                                        });
                                        setTimeout(startAutoScroll, 1000);
                                    });
                                });
    
                                track.addEventListener('scroll', updateDots, { passive: true });
                                window.addEventListener('resize', updateDots);
    
                                overlayClose.addEventListener('click', stopAutoScroll);
                                overlayModal.addEventListener('click', (e) => {
                                    if (e.target === overlayModal) stopAutoScroll();
                                });
    
                                updateDots();
                                startAutoScroll();
                            });
                        } else {
                            openOverlay(`
                                <div class="about-content">
                                    <h2>–ò–∑–≤–∏–Ω–∏—Ç–µ</h2>
                                    <p>–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è—Ö. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.</p>
                                </div>
                            `);
                        }
                    })
                    .catch(error => {
                        console.error('Error loading teacher files:', error);
                        openOverlay(`
                            <div class="about-content">
                                <h2>–û—à–∏–±–∫–∞</h2>
                                <p>–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.</p>
                            </div>
                        `);
                    });
            });
        }
    });
</script>



    <script src="https://dikidi.ru/assets/js/widget_record/widget2.min.js?v=1735141723"></script>
</body>
</html>



